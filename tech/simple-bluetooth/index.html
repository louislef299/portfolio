<!doctype html><html lang=en-us><head><meta http-equiv=X-Clacks-Overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Simple Bluetooth Communication Using Go | Louis Lefebvre</title>
<meta name=title content="Simple Bluetooth Communication Using Go"><meta name=description content="Just going to go over communicating over bluetooth in Go. Over the summer, I had
spent some time learning the basics of bluetooth and made a super simple
central and peripheral example in Go. Summarizing those learnings here.
Definitely go over the above link to help understand the rest of this quick
summary. I seem to frequently mess with bluetooth a bit and then don&rsquo;t touch it
for an extended period of time, so this is mostly a reference document for me to
get a quick refresher on the basics until I spend significant time at the
embedded level. Honestly, I spend way more time at the infrastructure and server
level, so that comes more naturally to me."><meta name=author content><meta name=keywords content><meta property="og:url" content="https://louislefebvre.net/tech/simple-bluetooth/"><meta property="og:site_name" content="Louis Lefebvre"><meta property="og:title" content="Simple Bluetooth Communication Using Go"><meta property="og:description" content="Just going to go over communicating over bluetooth in Go. Over the summer, I had spent some time learning the basics of bluetooth and made a super simple central and peripheral example in Go. Summarizing those learnings here.
Definitely go over the above link to help understand the rest of this quick summary. I seem to frequently mess with bluetooth a bit and then don’t touch it for an extended period of time, so this is mostly a reference document for me to get a quick refresher on the basics until I spend significant time at the embedded level. Honestly, I spend way more time at the infrastructure and server level, so that comes more naturally to me."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="tech"><meta property="article:published_time" content="2024-12-07T14:23:59-06:00"><meta property="article:modified_time" content="2024-12-07T14:23:59-06:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Simple Bluetooth Communication Using Go"><meta name=twitter:description content="Just going to go over communicating over bluetooth in Go. Over the summer, I had spent some time learning the basics of bluetooth and made a super simple central and peripheral example in Go. Summarizing those learnings here.
Definitely go over the above link to help understand the rest of this quick summary. I seem to frequently mess with bluetooth a bit and then don’t touch it for an extended period of time, so this is mostly a reference document for me to get a quick refresher on the basics until I spend significant time at the embedded level. Honestly, I spend way more time at the infrastructure and server level, so that comes more naturally to me."><meta itemprop=name content="Simple Bluetooth Communication Using Go"><meta itemprop=description content="Just going to go over communicating over bluetooth in Go. Over the summer, I had spent some time learning the basics of bluetooth and made a super simple central and peripheral example in Go. Summarizing those learnings here.
Definitely go over the above link to help understand the rest of this quick summary. I seem to frequently mess with bluetooth a bit and then don’t touch it for an extended period of time, so this is mostly a reference document for me to get a quick refresher on the basics until I spend significant time at the embedded level. Honestly, I spend way more time at the infrastructure and server level, so that comes more naturally to me."><meta itemprop=datePublished content="2024-12-07T14:23:59-06:00"><meta itemprop=dateModified content="2024-12-07T14:23:59-06:00"><meta itemprop=wordCount content="454"><meta name=referrer content="no-referrer-when-downgrade"><link href=/original.min.css rel=stylesheet><script src=/js/d3.v3.min.js></script><script src=/js/topojson.v1.min.js></script><script src=/js/datamaps.world.min.js></script></head><body><header><a class=skip-link href=#main-content>Skip to main content</a>
<a href=/ class=title><h1>Louis Lefebvre</h1></a><nav><a href=/tech/>Tech</a>
<a href=/travel/>Travel</a></nav></header><main id=main-content><h1>Simple Bluetooth Communication Using Go</h1><p class=byline><time datetime=2024-12-07 pubdate>2024-12-07</time></p><content><p>Just going to go over communicating over bluetooth in Go. Over the summer, I had
spent some time learning the <a href=https://learn.adafruit.com/introduction-to-bluetooth-low-energy/gap>basics of bluetooth</a> and made a super simple
central and peripheral example in Go. Summarizing those learnings here.</p><p>Definitely go over the above link to help understand the rest of this quick
summary. I seem to frequently mess with bluetooth a bit and then don&rsquo;t touch it
for an extended period of time, so this is mostly a reference document for me to
get a quick refresher on the basics until I spend significant time at the
embedded level. Honestly, I spend way more time at the infrastructure and server
level, so that comes more naturally to me.</p><h3 id=notes-on-gatt>Notes on GATT</h3><p>GAP is covered first, but mostly just goes over the advertisement protocol for
bluetooth. Here is a Go snippet that summarizes the basics of GAP:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Define the peripheral device info.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>adv</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>adapter</span>.<span style=color:#a6e22e>DefaultAdvertisement</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>adv</span>.<span style=color:#a6e22e>Configure</span>(<span style=color:#a6e22e>bluetooth</span>.<span style=color:#a6e22e>AdvertisementOptions</span>{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>LocalName</span>: <span style=color:#e6db74>&#34;loupi5&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Interval</span>:  <span style=color:#a6e22e>bluetooth</span>.<span style=color:#a6e22e>Duration</span>(<span style=color:#ae81ff>20000</span>),
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>The <strong>Generic ATTribute(GATT)</strong> Profile defines how BLE devices transfer data
back and forth using concepts called Services and Characteristics. GATT is
important to consider when a connection is established between two devices that
have already gone through the advertising process governed by GAP.</p><p>Only one peripheral device can be connected to a central at a time using GATT,
meaning that any advertising that had happened prior to GATT will not continue.
This connection then allows for two-way communication between devices.</p><p>GATT Servers(Peripherals) and Clients(Centrals) negotiate a connection interval
to transact data. This interval is just a recommendation, however, not a
requirement. The GATT transactions contain nested objects called <a href=https://www.bluetooth.com/specifications/specs/>Profiles</a>,
<a href=https://www.bluetooth.com/specifications/assigned-numbers/>Services and Characteristics</a>.</p><p><img src=/image/microcontrollers_GattStructure.png alt="Profiles, Services, and Chars"></p><h2 id=going-over-my-simple-example>Going over my simple example</h2><p>The central peripheral code can be found in my <a href=https://github.com/louislef299/ble-playground>ble-playground</a> repository.
It&rsquo;s pretty simple and doesn&rsquo;t do anything special, so I&rsquo;ll skip an in-depth
description and instead give this high-level diagram of what it does:</p><pre tabindex=0><code class=language-ascii data-lang=ascii>┌──────────────────┐            ┌──────────────────────┐
│                  │            │ Scan for device with │
│  PiZero loupi5   ┼─────────►  │ name loupi5. Once    │
│                  │            │ found: connect,      │
│                  ┼─────────►  │ discover services,   │
│    advertise..   │            │ and then disconnect  │
│                  ◄────────────┼                      │
│                  │            │   (Central)          │
│   (Peripheral)   │            └────────────────────── 
└──────────────────┘                                    </code></pre><p>The PiZero in this case was on my local network and I had it advertise bluetooth
using <a href=https://www.bluez.org/>bluez</a> and uploaded the Go binary with <code>scp</code>.</p><h2 id=where-do-i-want-to-go>Where do I want to Go?</h2><p>In a separate post, I would like to have a cylic TCP=>Bluetooth=>TCP
relationship between my computer and the pi5. It helps understand how to allow
the peripheral node to act as a sort of gateway to the central(where I need to
understand this architecture and how this ble interest started).</p></content><p></p><p><a href='mailto:louislefebvre1999@gmail.com?subject=Reply%20to%20"Simple%20Bluetooth%20Communication%20Using%20Go"'>Reply to this post by email ↪</a></p></main><footer><small>2023 Louis LeFebvre | Made With ❤️</small></footer></body></html>